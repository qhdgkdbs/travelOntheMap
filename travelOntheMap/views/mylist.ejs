<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">

<title>콜럼버스 맵, 당신의 여행지를 찾으세요!</title>

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="Tooplate">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="shortcut icon" href="https://i.postimg.cc/d061bMYv/favicon-1.png" type="image/x-icon">
<link rel="icon" href="https://i.postimg.cc/d061bMYv/favicon-1.png" type="image/x-icon">

<link rel="stylesheet" href="stylesheets/bootstrap.min.css">
<link rel="stylesheet" href="stylesheets/animate.css">
<link rel="stylesheet" href="stylesheets/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>


<!-- Main css -->
<link rel="stylesheet" href="stylesheets/tooplate-style.css">

</head>
<body data-spy="scroll" data-target=".navbar-collapse" data-offset="50">

<!-- PRE LOADER -->
<div class="preloader">
     <div class="spinner">
          <span class="spinner-rotate"></span>
     </div>
</div>


<!-- HOME SECTION -->
<div class="container">
     <div class="row">
          <section id="home" class="parallax-section">
               <div class="col-md-offset-1 col-md-10 col-sm-12">
                    <div class="home-wrapper">
                         <h3 class="wow fadeInUp" data-wow-delay="0.2s">랜 . 선 . 여. 행</h3>
                         <h1 class="wow fadeInUp" data-wow-delay="0.3s">내가 떠날, 나만의 여행지 🚀</h1>
                         <a href="#work" class="wow fadeInUp smoothScroll arrow-btn" data-wow-delay="0.6s"><i class="fa fa-angle-double-down"></i></a>
                    </div>
               </div>

          </section>
     </div>
</div>



<!-- WORK SECTION -->
<section id="work" class="parallax-section">
     <div class="container">
          <div class="row">

               <div class="col-md-12 col-sm-12">
                    <!-- SECTION TITLE -->
                    <div class="wow fadeInUp section-title" data-wow-delay="0.1s">
                         <h2>나의, 여행지들</h2>
                         <p>로그인 기능을 이용하지 않아, 같은 브라우져로 접속시에만 확인 할 수 있습니다!<br>언젠가 떠날 그 곳을 저장해둬요,<br>최대 20곳만 저장할 수 있으니 신중히 저장해요🙈</p>
                    </div>
               </div>
               <!-- WORK THUMB -->
               <div id = "recomandedSpot"></div>

          </div>
     </div>
</section>


<!-- CONTACT SECTION -->
<!-- <section id="contact" class="parallax-section">
     <div class="container">
          <div class="row">

               <div class="col-md-12 col-sm-12">
                    
                    <div class="wow fadeInUp section-title" data-wow-delay="0.2s">
                         <h2>Get in touch</h2>
                         <p>운영자와 연락을 하고 싶다면, qhdgkdbs@gmail.com으로 연락주세요</p>
                    </div>
               </div>

          </div>
     </div>
</section> -->


<!-- FOOTER SECTION -->
<footer id="footer" class="parallax-section">
    <div class="container">
        <div class="row">

               <div class="wow fadeInUp col-md-4 col-sm-4" data-wow-delay="0.2s">
                    <h4>Map Area - 콜럼버스</h4>
                    <p>당신이 발견할 새로운 공간</p>
               </div>

               <div class="wow fadeInUp col-md-4 col-sm-4" data-wow-delay="0.4s">
                    <div class="support-cus">
                         <h4>Get in touch</h4>
                         <p>운영자와 연락을 하고 싶다면, qhdgkdbs@gmail.com으로 연락주세요</p>
                    </div>

               </div>

               <div class="wow fadeInUp col-md-4 col-sm-4" data-wow-delay="0.6s">
                    <div class="support-cus">
                         <h4>관련 사이트</h4>
                         <p><a href="#">콜럼버스 - 여행의 새 지도</a></p>
                         <p><a href="#">맵슐랭 - 맛집의 발견</a></p>
                    </div>
               </div>

          </div>
     </div>
</footer>

<!-- SCRIPTS -->
<script>
     // var urlAdd = "http://localhost:3000/"  
     var urlAdd = "https://itjusttravel.herokuapp.com/"


     var output = localStorage.getItem("key");		
     var myListArr = []
     myListArr=JSON.parse(output);

     var dataList;
     var htmlData = "";

     $.ajax({
          url :  urlAdd + 'file/',
          dataType :"json", // 데이터타입을 json 으로 받아옴
          success : function(data) {
               // alert("data로딩이 완료되었습니다.")
               dataList = data;
               setContent(); 
               // $('#loading').hide();  
          },
          error : function(e) {
               console.log(e.responseText);
               console.log(e);
          }
     })


     var setContent = function() {
          // console.log(dataList)
          // if(!myListArr)myListArr=[0]

          var content = `<div class="card">`

          for(var target of dataList){
               if(myListArr){
                    //나의 여행지가 있을경우
                    if(myListArr.includes(target._id)){

                         isitSavedImg = "https://i.postimg.cc/sgQGXBGD/icon-18.png";

                         content = content +      
                              `
                              <div class="wow fadeInUp col-md-3 col-sm-6" data-wow-delay="0.1s">               
                                   <div class="work-thumb" style = "margin-bottom:0px;">
                                        <a href="${target.moreLink}" class="image-popup">
                                             <img src="${target.picLink}" class="img-responsive" alt="Fine Arts">
                                        </a>
                                   </div>
                                   <div onclick='saveOrDeleteRedirect("${target._id}")' style = "margin-bottom:5px;text-align:right;"><img class= "isItSavedImg" src="${isitSavedImg}" alt="heelo" width="20" height="20" ></div>

                                   <div>
                                        <a href="${target.moreLink}" style="background-color: cadetblue; color: beige; font-size:18px; padding : 3px; border-radius:5px; width:100%">
                                             지금, <span style="color:white;">${target.spot}</span>로 떠나기 🚀🚀
                                        </a>
                                   </div>
                              </div>
                              ` 
                    }  
               }else{
                    // 나의 여행지가 한 곳도 없을 경우.
                    break;
               }
          }
     
          if(myListArr.length === 0){
               content = content +      
                    `
                    <div class="wow fadeInUp col-md-3 col-sm-6" data-wow-delay="0.1s">               
                         <div class="work-thumb" style = "margin-bottom:0px;">
                              <div>저장된 나의 여행지가 없습니다..</div>
                         </div>
                    </div>
                    ` 
          }

          htmlData = htmlData + content +`</div>`        

          $("#recomandedSpot").html(htmlData)
     } 

     function saveOrDeleteRedirect(id){
          var output = localStorage.getItem("key");		
          var myListArr = [0];
          if(output){
               myListArr = JSON.parse(output);
          }
          
          //팝업으로 다시한번 물어보기
          var r = confirm("나의 여행지에서 삭제 하시겠어요?");
          if (r == true) {
               //삭제 + 저장
               myListArr.splice(myListArr.indexOf(id),1)
               localStorage.setItem("key", JSON.stringify(myListArr));
               location.reload()
          } else {
          
          }
          
          // window.location.href =urlAdd;
     }


</script>
<script src="js/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.parallax.js"></script>
<script src="js/smoothscroll.js"></script>
<script src="js/wow.min.js"></script>
<script src="js/custom.js"></script>

</body>
</html>